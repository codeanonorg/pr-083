parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"E8WP":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.colors=void 0;var f={red:["#ff0000","#ff8080","#100000"],green:["#00ff00","#80ff80","#001000"],light:["#80ff80","#80ff80","#001000"],blue:["#0000ff","#8080ff","#000010"]};exports.colors=f;
},{}],"ji7c":[function(require,module,exports) {
"use strict";function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function e(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function n(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var i=function(){function e(n,i){t(this,e),this.x=n,this.y=i}return n(e,[{key:"equal",value:function(t){return this.x===t.x&&this.y===t.y}},{key:"set",value:function(t,e){this.x=t,this.y=e}},{key:"add",value:function(t){return new e(this.x+t.x,this.y+t.y)}},{key:"addMut",value:function(t){this.x+=t.x,this.y+=t.y}},{key:"scale",value:function(t){return new e(this.x*t,this.y*t)}},{key:"scaleMut",value:function(t){this.x*=t,this.y*=t}},{key:"inRect",value:function(t,e){return this.x>t.x&&this.x<t.x+e.x&&this.y>t.y&&this.y<t.y+e.y}},{key:"copy",value:function(){return new e(this.x,this.y)}},{key:"toString",value:function(){return"P83Vector(".concat(this.x,", ").concat(this.y,")")}},{key:"magnitude",get:function(){return Math.sqrt(this.x*this.x+this.y*this.y)}}],[{key:"add",value:function(t,e){return t.add(e)}}]),e}();exports.default=i,i.zero=new i(0,0);
},{}],"l3Vy":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=t(require("./vector.js"));function t(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function r(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}var i=function(){function t(){n(this,t),this.position=new e.default(0,0),this.speed=new e.default(0,0)}return r(t,[{key:"accelerate",value:function(t){var n=new e.default((t-1)%3-1,Math.floor((t-1)/3)-1);this.speed.addMut(n),this.position.addMut(this.speed)}},{key:"isMotionless",value:function(){return this.speed.equal(e.default.zero)}},{key:"toString",value:function(){return"SPEED: ".concat(this.speed.toString(),"\nPOSITION: ").concat(this.position.toString())}}]),t}();exports.default=i;
},{"./vector.js":"ji7c"}],"Dcy0":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.P83Number=exports.P83Input=exports.P83Display=exports.P83MenuItem=exports.P83Button=exports.P83LED=exports.P83Title=void 0;var t=require("./consts.js"),i=s(require("./vector.js"));function s(t){return t&&t.__esModule?t:{default:t}}function o(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}function e(t,i){for(var s=0;s<i.length;s++){var o=i[s];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function h(t,i,s){return i&&e(t.prototype,i),s&&e(t,s),t}var l=function(){function i(t,s,e,h){o(this,i),this.parent=t,this.root=this.parent.root,this.pos=s,this.size=e,this.title=h}return h(i,[{key:"draw",value:function(){var i=this.root.ctx,s=this.root.unit,o=i.measureText(this.title).width;i.fillStyle=t.colors.light[0],i.shadowBlur=0,i.font=Math.floor(.8*s)+"px 'Be Vietnam'",i.textAlign="left",i.textBaseline="middle",i.fillText(this.title,(this.pos.x+2)*s,(this.pos.y+1)*s),i.lineWidth=2,i.strokeStyle=t.colors.light[0],i.beginPath(),i.moveTo((this.pos.x+1.5)*s,(this.pos.y+1)*s),i.lineTo((this.pos.x+1)*s,(this.pos.y+1)*s),i.lineTo((this.pos.x+1)*s,(this.pos.y+2)*s),i.stroke(),i.beginPath(),i.moveTo((this.pos.x+2.5)*s+o,(this.pos.y+1)*s),i.lineTo((this.pos.x+this.size.x-1)*s,(this.pos.y+1)*s),i.lineTo((this.pos.x+this.size.x-1)*s,(this.pos.y+2)*s),i.stroke(),i.beginPath(),i.moveTo((this.pos.x+1)*s,(this.pos.y+this.size.y-2)*s),i.lineTo((this.pos.x+1)*s,(this.pos.y+this.size.y-1)*s),i.lineTo((this.pos.x+this.size.x-1)*s,(this.pos.y+this.size.y-1)*s),i.lineTo((this.pos.x+this.size.x-1)*s,(this.pos.y+this.size.y-2)*s),i.stroke()}}]),i}();exports.P83Title=l;var n=function(){function i(s,e){o(this,i),this.parent=s,this.root=this.parent.root,this.pos=e,this.lit=!0,this.blinking=!1,this.nbTimeouts=0,this.colors=t.colors.green,this.blip=document.getElementById("blip")}return h(i,[{key:"draw",value:function(){var t=this.root.ctx,i=this.root.unit;this.lit?(t.fillStyle=this.colors[0],t.strokeStyle=this.colors[0],t.shadowBlur=i,t.shadowColor=this.colors[1]):(t.strokeStyle="#101010",t.fillStyle=this.colors[2],t.shadowBlur=0),t.beginPath(),t.arc(i*this.pos.x,i*this.pos.y,i/3,0,2*Math.PI),t.stroke(),t.fill()}},{key:"blink",value:function(t){var i=this;if(this.blinking)switch(t){case 0:this.lit=!0,this.parent.draw();break;case 1:0===this.nbTimeouts&&(this.nbTimeouts=1,setTimeout(function(){return i.blink(2)}));break;case 2:if(this.nbTimeouts--,this.nbTimeouts>0)return;this.lit=!this.lit,this.parent.draw(),this.lit&&this.blip&&(this.blip.volume=.1,this.blip.play()),this.nbTimeouts=1,setTimeout(function(){return i.blink(2)},300)}}}]),i}();exports.P83LED=n;var r=function(){function s(i,e,h,l,n,r){o(this,s),this.root=i.root,this.pos=e,this.size=h,this.text=l,this.onCb=n||f,this.offCb=r||f,this.active=!0,this.lit=!1,this.audio=document.getElementById("click"),this.colors=t.colors.green}return h(s,[{key:"draw",value:function(){var i=this.root.ctx,s=this.root.unit;this.active?(this.lit?this.colors=t.colors.light:this.colors=t.colors.green,i.shadowBlur=s/2,i.fillStyle=this.colors[2],i.strokeStyle=this.colors[0],i.shadowColor=this.colors[1]):(i.strokeStyle="#101010",i.fillStyle=this.colors[2],i.shadowBlur=0),i.fillRect(this.pos.x*s,this.pos.y*s,this.size.x*s,this.size.y*s),i.strokeRect(this.pos.x*s,this.pos.y*s,this.size.x*s,this.size.y*s),i.fillStyle="#000000",this.active&&(i.fillStyle=this.colors[0],i.shadowBlur=s/4,i.shadowColor=this.colors[1]),i.font=Math.floor(5/4*s)+"px 'Nova Mono'",i.textAlign="center",i.textBaseline="top",i.fillText(this.text,(this.pos.x+this.size.x/2)*s,(this.pos.y+.5)*s)}},{key:"onClick",value:function(t){if(this.active&&!this.lit){var s=this.root.unit,o=t.add(this.pos.scale(-s));this.lit=o.inRect(i.default.zero,this.size.scale(s)),this.lit&&(this.audio&&(this.audio.volume=.1,this.audio.play()),console.log("click"),setTimeout(this.off.bind(this),200),this.onCb.call(this))}}},{key:"off",value:function(){this.lit=!1,this.offCb.call(this),this.draw()}}]),s}();exports.P83Button=r;var a=function(){function s(t,e,h,l,n){o(this,s),this.root=t.root,this.pos=e,this.text=h,this.button=new r(this,e,new i.default(1,1),"",l,n)}return h(s,[{key:"draw",value:function(){var s=this.root.ctx,o=this.root.unit,e=this.pos.add(new i.default(2,.5)).scale(o);s.fillStyle=t.colors.light[0],s.shadowBlur=0,s.textAlign="left",s.font="".concat(Math.floor(.8*o),"px 'Be Vietnam'"),s.textBaseline="middle",s.fillText(this.text,e.x,e.y),this.button.draw()}},{key:"onClick",value:function(t){this.button.onClick(t)}}]),s}();exports.P83MenuItem=a;var u=function(){function i(s,e,h){o(this,i),this.parent=s,this.root=this.parent.root,this.pos=e,this.size=h,this.value="",this.colors=t.colors.green}return h(i,[{key:"draw",value:function(){var t=this.root.ctx,i=this.root.unit;t.shadowBlur=0,t.fillStyle=this.colors[2],t.strokeStyle="#101010",t.fillRect(this.pos.x*i,this.pos.y*i,(.71*this.size+.5)*i,2*i),t.strokeRect(this.pos.x*i,this.pos.y*i,(.71*this.size+.5)*i,2*i),t.fillStyle=this.colors[0],t.shadowBlur=i/4,t.shadowColor=this.colors[1],t.font="".concat(Math.floor(5/4*i),"px 'Nova Mono'"),t.textAlign="left",t.textBaseline="top";var s=this.value;s.length>this.size&&(s=this.value.substring(s.length-this.size,s.length)),t.fillText(s,(this.pos.x+.25)*i,(this.pos.y+.5)*i)}}]),i}();exports.P83Display=u;var p=function(){function i(s,e,h,l,n){o(this,i),this.parent=s,this.root=this.parent.root,this.pos=e,this.size=h,this.callback=n,this.colors=t.colors.green,this.input=document.getElementById(l),this.input.value="",this.input.addEventListener("input",this.onInput.bind(this)),this.input.addEventListener("keyup",this.onKeyup.bind(this)),this.authorizedChars="",this.popping=!1}return h(i,[{key:"draw",value:function(){var i=this.root.canvas,s=this.root.unit;this.input.style.left=i.offsetLeft+this.pos.x*s+"px",this.input.style.top=i.offsetTop+this.pos.y*s+"px",this.input.style.width=Math.floor((.71*this.size+.5)*s)-2+"px",this.input.style.height=2*s-2+"px",this.input.style.backgroundColor=t.colors.green[2],this.input.style.font=Math.floor(5/4*s)+"px 'Nova Mono'",this.input.style.color=t.colors.green[0],this.input.style.textShadow="0 0 "+Math.floor(s/4)+"px "+t.colors.green[1],this.input.style.border="1px solid #101010"}},{key:"setup",value:function(t){this.input.value="",this.authorizedChars=t}},{key:"onInput",value:function(){var t="",i=!0,s=!1,o=void 0;try{for(var e,h=this.input.value[Symbol.iterator]();!(i=(e=h.next()).done);i=!0){var l=e.value;this.authorizedChars.indexOf(l)>=0&&(t+=l)}}catch(n){s=!0,o=n}finally{try{i||null==h.return||h.return()}finally{if(s)throw o}}this.input.value=t}},{key:"onKeyup",value:function(t){"Enter"===t.key&&(this.popping||this.pop())}},{key:"pop",value:function(){this.popping=!1,0!==this.input.value.length&&this.callback(parseInt(this.input.value[0]))&&(this.input.value=this.input.value.slice(1),this.popping=!0,setTimeout(this.pop.bind(this),100))}},{key:"show",value:function(t){t?(this.input.style.visibility="visible",this.input.style.zIndex="1"):(this.input.style.visibility="hidden",this.input.style.zIndex="-1")}}]),i}();exports.P83Input=p;var c=function(){function t(i,s,e){o(this,t),this.parent=i,this.root=this.parent.root,this.size=e,this.value=NaN,this.display=new u(this,s,e)}return h(t,[{key:"draw",value:function(){var t=" ",i=this.value;isNaN(i)?this.display.value=":-(":(i<0&&(t="-",i*=-1),this.display.value=t+i.toFixed().padStart(this.size,"0")),this.display.draw()}}]),t}();function f(){}exports.P83Number=c;
},{"./consts.js":"E8WP","./vector.js":"ji7c"}],"aUdC":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.P83TargetSelector=exports.P83Targets=void 0;var t=require("./consts.js"),e=require("./display.js"),i=n(require("./vector.js"));function n(t){return t&&t.__esModule?t:{default:t}}function r(t,e){return a(t)||o(t,e)||s()}function s(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function o(t,e){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)){var i=[],n=!0,r=!1,s=void 0;try{for(var o,a=t[Symbol.iterator]();!(n=(o=a.next()).done)&&(i.push(o.value),!e||i.length!==e);n=!0);}catch(l){r=!0,s=l}finally{try{n||null==a.return||a.return()}finally{if(r)throw s}}return i}}function a(t){if(Array.isArray(t))return t}function l(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function h(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function u(t,e,i){return e&&h(t.prototype,e),i&&h(t,i),t}var c=function(){function t(e,n){l(this,t),this.positions=[],this.checked=[];for(var r=0;r<e.length;r+=2)this.positions.push(new i.default(e[r],e[r+1])),this.checked.push(!1);this.isTrackingOk=n}return u(t,[{key:"check",value:function(e){for(var i=t.CHECK_STATE_POSITION,n=0;n<this.positions.length;n++){this.positions[n].equal(e.position)&&(this.isTrackingOk||e.isMotionless())&&(i=t.CHECK_STATE_BOTH,this.checked[n]||(this.checked[n]=!0))}return i}},{key:"checkAll",value:function(){return this.nbChecked===this.checked.length}},{key:"targetsString",value:function(){var t="A".charCodeAt(0);return this.positions.map(function(e,i){return" ".concat(String.fromCharCode(t+i),": (").concat(e.toString(),")")}).join("\n")}},{key:"checkedString",value:function(){var t="A".charCodeAt(0);return this.checked.map(function(t,e){return[t,e]}).filter(function(t){var e=r(t,2),i=e[0];e[1];return i}).map(function(e){var i=r(e,2),n=(i[0],i[1]);return String.fromCharCode(t+n)}).join(" ")}},{key:"nbChecked",get:function(){return this.checked.filter(Boolean).length}}]),t}();exports.P83Targets=c,c.CHECK_STATE_POSITION=Symbol(),c.CHECK_STATE_BOTH=Symbol(),c.CHECK_STATE_NONE=Symbol();var f=function(){function n(t,r,s,o){l(this,n),this.parent=t,this.root=this.parent.root,this.pos=r,this.size=new i.default(14,21),this.mission=s,this.callback=o,this.title=new e.P83Title(this,this.pos,this.size,"TARGET SELECTOR"),this.led=new e.P83LED(this,i.default.add(this.pos,new i.default(2.5,17.5)),8),this.numX=new e.P83Number(this,i.default.add(this.pos,new i.default(6,15.5)),8),this.numY=new e.P83Number(this,i.default.add(this.pos,new i.default(6,17.5)),8),this.selected=0,this.buttons=[];for(var a=0;a<20;a++){var h=new e.P83Button(this,i.default.add(this.pos,new i.default(2+8/3*(a%4),2+8/3*Math.floor(a/4))),new i.default(2,2),String.fromCharCode("A".charCodeAt(0)+a),this.select.bind(this,a));h.active=a<this.mission.nbTargets,this.buttons.push(h)}}return u(n,[{key:"draw",value:function(){var e=this.root.ctx,i=this.root.unit;e.fillStyle="#000000",e.shadowBlur=0,e.fillRect(this.pos.x*i,this.pos.y*i,this.size.x*i,this.size.y*i),this.title.draw();for(var n=0;n<this.buttons.length;n++)this.buttons[n].draw();this.led.draw(),e.fillStyle=t.colors.light[0],e.shadowBlur=0,e.textAlign="left",e.font=Math.floor(.8*i)+"px 'Be Vietnam'",e.textBaseline="middle",e.fillText("X",(this.pos.x+4)*i,(this.pos.y+16.5)*i),e.fillText("Y",(this.pos.x+4)*i,(this.pos.y+18.5)*i);var r=this.numX.value=this.mission.targets.positions[this.selected];this.numX.value=r.x,this.numY.value=r.y,this.numX.draw(),this.numY.draw()}},{key:"select",value:function(t){for(var e=0;e<this.mission.nbTargets;e++)this.buttons[e].lit=e===t;this.selected=t,this.callback(t),this.draw()}},{key:"onClick",value:function(t){var e=!0,i=!1,n=void 0;try{for(var r,s=this.buttons[Symbol.iterator]();!(e=(r=s.next()).done);e=!0){r.value.onClick(t)}}catch(o){i=!0,n=o}finally{try{e||null==s.return||s.return()}finally{if(i)throw n}}}}]),n}();exports.P83TargetSelector=f;
},{"./consts.js":"E8WP","./display.js":"Dcy0","./vector.js":"ji7c"}],"UGYH":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=n(require("./probe.js")),t=require("./targets.js");function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function r(e,t,n){return t&&s(e.prototype,t),n&&s(e,n),e}var o=function(){function n(s,r,o,a,c,h){i(this,n),this.name=s,this.code=r,this.probe=new e.default,this.targets=new t.P83Targets(o,c),this.diagonalAllowed=a,this.trackingAllowed=c,this.oxygenStartLevel=h,this.sequence="",this.isSpeedOk=!0,this.isAchieved=!1}return r(n,[{key:"move",value:function(e){if(!(e<1||e>9))switch(this.sequence+=e.toFixed(),this.probe.accelerate(e),this.targets.check(this.probe)){case t.P83Targets.CHECK_STATE_POSITION:this.isSpeedOk=!1;break;case t.P83Targets.CHECK_STATE_BOTH:this.isSpeedOk=!0,this.targets.checkAll()&&(this.isAchieved=!0)}}},{key:"toString",value:function(){return a("MISSION: ".concat(this.name,"\n    TELEPORTATION CODE: ").concat(this.code,"\n    *** DESCRIPTION ***\n    TARGETS:\n    ").concat(this.targets.targetsString(),"\n    DIAGONAL THRUST: ").concat(this.diagonalAllowed?"YES":"NO","\n    TRACKING DEVICE: ").concat(this.trackingAllowed?"YES":"NO","\n    OXYGEN AT DEPARTURE: ").concat(this.oxygenStartLevel,"\n    \n    *** CURRENT STATUS ***\n    ").concat(0===this.sequence.length?"":"SEQUENCE: ".concat(this.sequence),"\n    PROBE:\n    ").concat(this.probe.toString(),"\n    VALIDATED TARGETS: ").concat(0===this.nbTargets?"NONE":this.targets.checkedString(),"\n    REMAINING OXYGEN: ").concat(this.oxygenLevel))}},{key:"oxygenLevel",get:function(){return this.oxygenStartLevel-this.sequence.length}},{key:"nbTargets",get:function(){return this.targets.positions.length}}]),n}();function a(e){return e.split("\n").map(function(e){return e.trim()}).join("\n")}exports.default=o;
},{"./probe.js":"l3Vy","./targets.js":"aUdC"}],"eVqE":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.P83MissionPanel=exports.P83SequencePanel=exports.P83ThrustPanel=exports.default=exports.P83XYPanel=void 0;var t=require("./consts.js"),i=require("./display.js"),e=s(require("./vector.js"));function s(t){return t&&t.__esModule?t:{default:t}}function o(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}function n(t,i){for(var e=0;e<i.length;e++){var s=i[e];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}function l(t,i,e){return i&&n(t.prototype,i),e&&n(t,e),t}var a=function(){function s(t,n,l,a){o(this,s),this.parent=t,this.root=this.parent.root,this.pos=n,this.size=new e.default(14,7),this.title=new i.P83Title(this,this.pos,this.size,l),this.vector=a,this.led=new i.P83LED(this,this.pos.add(new e.default(2.5,3.5)),this.size,l),this.numX=new i.P83Number(this,e.default.add(this.pos,new e.default(6,1.5)),8,this.vector.x),this.numY=new i.P83Number(this,e.default.add(this.pos,new e.default(6,3.5)),8,this.vector.y)}return l(s,[{key:"draw",value:function(){var i=this.root.ctx,e=this.root.unit;i.fillStyle="#000000",i.shadowBlur=0,i.fillRect(this.pos.x*e,this.pos.y*e,this.size.x*e,this.size.y*e),this.title.draw(),this.led.draw(),i.fillStyle=t.colors.light[0],i.shadowBlur=0,i.textAlign="left",i.font=Math.floor(.8*e)+"px 'Be Vietnam'",i.textBaseline="middle",i.fillText("X",(this.pos.x+4)*e,(this.pos.y+2.5)*e),i.fillText("Y",(this.pos.x+4)*e,(this.pos.y+4.5)*e),this.numX.value=this.vector.x,this.numY.value=this.vector.y,this.numX.draw(),this.numY.draw()}}]),s}();exports.P83XYPanel=a;var h=function(){function s(t,n,l){o(this,s),this.parent=t,this.root=this.parent.root,this.pos=n,this.size=new e.default(14,7),this.mission=l,this.title=new i.P83Title(this,this.pos,this.size,"STATUS"),this.oxygenLED=new i.P83LED(this,new e.default(this.pos.x+2.5,this.pos.y+2.5)),this.oxygenNum=new i.P83Number(this,new e.default(this.pos.x+8,this.pos.y+1.5),5),this.trackingLED=new i.P83LED(this,new e.default(this.pos.x+2.5,this.pos.y+4.5))}return l(s,[{key:"draw",value:function(){var i=this.root.ctx,e=this.root.unit;i.fillStyle="#000000",i.shadowBlur=0,i.fillRect(this.pos.x*e,this.pos.y*e,this.size.x*e,this.size.y*e),this.title.draw(),i.fillStyle=t.colors.light[0],i.shadowBlur=0,i.textAlign="left",i.font=Math.floor(.8*e)+"px 'Be Vietnam'",i.textBaseline="middle",i.fillText("OXYGEN",(this.pos.x+4)*e,(this.pos.y+2.5)*e),i.fillText("TRACKING DEVICE",(this.pos.x+4)*e,(this.pos.y+4.5)*e),this.mission.oxygenLevel>1?this.oxygenLED.colors=t.colors.green:this.oxygenLED.colors=t.colors.red,this.oxygenNum.value=this.mission.oxygenLevel,this.mission.trackingAllowed?this.trackingLED.colors=t.colors.green:this.trackingLED.colors=t.colors.red,this.oxygenNum.draw(),this.oxygenLED.draw(),this.trackingLED.draw()}}]),s}();exports.default=h;var r=function(){function s(t,n,l,a){o(this,s),this.parent=t,this.root=this.parent.root,this.pos=n,this.size=new e.default(14,14),this.mission=l,this.move_callback=a,this.title=new i.P83Title(this,this.pos,this.size,"THRUST"),this.diagonalAllowed=!0,this.buttons=[];for(var h=0;h<9;h++){var r=e.default.add(this.pos,new e.default(3.5+h%3*2.5,8.5-2.5*Math.floor(h/3))),u=new e.default(2,2);this.buttons.push(new i.P83Button(this,r,u,"".concat(h+1),this.move_callback.bind(this,h+1)))}if(this.mission.diagonalAllowed){var d=!0,f=!1,w=void 0;try{for(var p,c=this.buttons[Symbol.iterator]();!(d=(p=c.next()).done);d=!0){p.value.active=!0}}catch(x){f=!0,w=x}finally{try{d||null==c.return||c.return()}finally{if(f)throw w}}}else for(var y=0;y<9;y++)this.buttons[y].active=4!==y&&y%2==0}return l(s,[{key:"clear",value:function(){var t=!0,i=!1,e=void 0;try{for(var s,o=this.buttons[Symbol.iterator]();!(t=(s=o.next()).done);t=!0){s.value.lit=!1}}catch(n){i=!0,e=n}finally{try{t||null==o.return||o.return()}finally{if(i)throw e}}this.draw()}},{key:"drawArrow",value:function(i,e,s){var o=this.root.ctx,n=this.root.unit;o.strokeStyle=t.colors.light[0],o.shadowBlur=0,o.beginPath(),o.moveTo(i.x*n,i.y*n),o.lineTo(e.x*n,e.y*n),o.lineTo(s.x*n,s.y*n),o.stroke()}},{key:"draw",value:function(){var t=this.root.ctx,i=this.root.unit;t.fillStyle="#000000",t.shadowBlur=0,t.fillRect(this.pos.x*i,this.pos.y*i,this.size.x*i,this.size.y*i),this.title.draw();for(var s=0;s<this.buttons.length;s++)this.buttons[s].draw();this.drawArrow(e.default.add(this.pos,new e.default(3,9.5)),e.default.add(this.pos,new e.default(3,11)),e.default.add(this.pos,new e.default(4.5,11))),this.drawArrow(e.default.add(this.pos,new e.default(6,11)),e.default.add(this.pos,new e.default(7,12)),e.default.add(this.pos,new e.default(8,11))),this.drawArrow(e.default.add(this.pos,new e.default(11,9.5)),e.default.add(this.pos,new e.default(11,11)),e.default.add(this.pos,new e.default(9.5,11))),this.drawArrow(e.default.add(this.pos,new e.default(11,6)),e.default.add(this.pos,new e.default(12,7)),e.default.add(this.pos,new e.default(11,8))),this.drawArrow(e.default.add(this.pos,new e.default(11,4.5)),e.default.add(this.pos,new e.default(11,3)),e.default.add(this.pos,new e.default(9.5,3))),this.drawArrow(e.default.add(this.pos,new e.default(6,3)),e.default.add(this.pos,new e.default(7,2)),e.default.add(this.pos,new e.default(8,3))),this.drawArrow(e.default.add(this.pos,new e.default(3,4.5)),e.default.add(this.pos,new e.default(3,3)),e.default.add(this.pos,new e.default(4.5,3))),this.drawArrow(e.default.add(this.pos,new e.default(3,6)),e.default.add(this.pos,new e.default(2,7)),e.default.add(this.pos,new e.default(3,8)))}},{key:"onClick",value:function(t){var i=!0,e=!1,s=void 0;try{for(var o,n=this.buttons[Symbol.iterator]();!(i=(o=n.next()).done);i=!0){o.value.onClick(t)}}catch(l){e=!0,s=l}finally{try{i||null==n.return||n.return()}finally{if(e)throw s}}}}]),s}();exports.P83ThrustPanel=r;var u=function(){function s(t,n,l,a){o(this,s),this.parent=t,this.root=this.parent.root,this.mission=l,this.pos=n,this.size=new e.default(42,7),this.title=new i.P83Title(this,this.pos,this.size,"THRUST SEQUENCE"),this.sequence=new i.P83Display(this,e.default.add(this.pos,new e.default(9.75,1.5)),42),this.sequenceInput=new i.P83Input(this,e.default.add(this.pos,new e.default(9.75,3.5)),42,"input",a),this.mission.diagonalAllowed?this.sequenceInput.setup("123456789"):this.sequenceInput.setup("24568")}return l(s,[{key:"draw",value:function(){var i=this.root.ctx,e=this.root.unit;this.sequenceInput.show(!0),i.fillStyle="#000000",i.shadowBlur=0,i.fillRect(this.pos.x*e,this.pos.y*e,this.size.x*e,this.size.y*e),this.title.draw(),i.fillStyle=t.colors.light[0],i.shadowBlur=0,i.textAlign="left",i.font=Math.floor(.8*e)+"px 'Be Vietnam'",i.textBaseline="middle",i.fillText("SEQUENCE",(this.pos.x+2)*e,(this.pos.y+2.5)*e),i.fillText("KEYBOARD INPUT",(this.pos.x+2)*e,(this.pos.y+4.5)*e),this.sequence.value=this.mission.sequence,this.sequence.draw(),this.sequenceInput.draw()}}]),s}();exports.P83SequencePanel=u;var d=function(){function t(s,n,l,a){o(this,t),this.parent=s,this.root=this.parent.root,this.pos=n,this.size=new e.default(14,7),this.mission=l,this.quitCallback=a,this.title=new i.P83Title(this,this.pos,this.size,"MISSION"),this.printMenuItem=new i.P83MenuItem(this,e.default.add(this.pos,new e.default(2,2)),"PRINT",this.draw.bind(this),this.print.bind(this)),this.quitMenuItem=new i.P83MenuItem(this,e.default.add(this.pos,new e.default(2,4)),"QUIT",this.draw.bind(this),this.quit.bind(this))}return l(t,[{key:"print",value:function(){this.printMenuItem.lit=!1,this.draw(),window.open("app:text,"+encodeURI(this.mission.toString()),"_blank")}},{key:"draw",value:function(){var t=this.root.ctx,i=this.root.unit;t.fillStyle="#000",t.shadowBlur=0,t.fillRect(this.pos.x*i,this.pos.y*i,this.size.x*i,this.size.y*i),this.title.draw(),this.printMenuItem.draw(),this.quitMenuItem.draw()}},{key:"onClick",value:function(t){this.printMenuItem.onClick(t),this.quitMenuItem.onClick(t)}},{key:"quit",value:function(){this.quitMenuItem.lit=!1,this.draw(),this.quitCallback()}}]),t}();exports.P83MissionPanel=d;
},{"./consts.js":"E8WP","./display.js":"Dcy0","./vector.js":"ji7c"}],"oeM6":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t=require("./consts.js");function i(t){return o(t)||e(t)||s()}function s(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function e(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}function o(t){if(Array.isArray(t)){for(var i=0,s=new Array(t.length);i<t.length;i++)s[i]=t[i];return s}}function n(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}function r(t,i){for(var s=0;s<i.length;s++){var e=i[s];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,e.key,e)}}function h(t,i,s){return i&&r(t.prototype,i),s&&r(t,s),t}var a=function(){function s(i,e,o,r){n(this,s),this.parent=i,this.root=this.parent.root,this.pos=e,this.size=o,this.mission=r,this.selected=0,this.colors=t.colors.light}return h(s,[{key:"computeDimensions",value:function(){var t=[].concat(i(this.mission.targets.positions),[this.mission.probe.position]),s=t.map(function(t){return t.x});this.min_x=Math.min.apply(Math,i(s)),this.max_x=Math.max.apply(Math,i(s));var e=t.map(function(t){return t.y});this.min_y=Math.min.apply(Math,i(e)),this.max_y=Math.max.apply(Math,i(e));var o=Math.max(1,(this.max_x-this.min_x)/(this.size.x-4),(this.max_y-this.min_y)/(this.size.y-4)),n=(this.max_x+this.min_x)/2,r=(this.max_y+this.min_y)/2;this.min_x=n-o*(this.size.x-2)/2,this.max_x=n+o*(this.size.x-2)/2,this.min_y=r-o*(this.size.y-2)/2,this.max_y=r+o*(this.size.y-2)/2}},{key:"drawGrid",value:function(t){var i=this.root.ctx,s=this.root.unit,e=Math.min(1,(this.size.x-2)/(this.max_x-this.min_x)/10*t),o="rgba(128, 255, 128, ".concat(e,")");i.strokeStyle=o,i.shadowColor=o,i.shadowBlur=4*e;for(var n=Math.ceil(this.min_x/t)*t;n<Math.ceil(this.max_x/t)*t;){var r=this.pos.x+1+(n-this.min_x)/(this.max_x-this.min_x)*(this.size.x-2);i.beginPath(),i.moveTo(r*s,(this.pos.y+1)*s),i.lineTo(r*s,(this.pos.y+this.size.y-1)*s),i.stroke(),n+=t}for(var h=Math.ceil(this.min_y/t)*t;h<Math.ceil(this.max_y/t)*t;){var a=this.pos.y+1+(this.max_y-h)/(this.max_y-this.min_y)*(this.size.y-2);i.beginPath(),i.moveTo((this.pos.x+1)*s,a*s),i.lineTo((this.pos.x+this.size.x-1)*s,a*s),i.stroke(),h+=t}}},{key:"drawFullGrids",value:function(){var t=this.root.ctx,i=this.root.unit;t.shadowBlur=0,t.fillStyle=this.colors[2],t.fillRect(this.pos.x*i,this.pos.y*i,this.size.x*i,this.size.y*i),t.lineWidth=0,t.strokeStyle=this.colors[0],t.shadowBlur=i/4,t.shadowColor=this.colors[1],t.strokeRect((this.pos.x+1)*i,(this.pos.y+1)*i,(this.size.x-2)*i,(this.size.y-2)*i);var s=Math.pow(10,Math.ceil(Math.log10((this.max_x-this.min_x)/(this.size.x-2)*10)));s=Math.max(100,s),this.drawGrid(s/100),this.drawGrid(s/10),this.drawGrid(s)}},{key:"drawElement",value:function(i,s,e,o){var n=this.root.ctx,r=this.root.unit,h=this.pos.x+1+(i.x-this.min_x)/(this.max_x-this.min_x)*(this.size.x-2),a=this.pos.y+1+(this.max_y-i.y)/(this.max_y-this.min_y)*(this.size.y-2);e?(n.strokeStyle=t.colors.green[0],n.fillStyle=t.colors.green[0]):(n.strokeStyle=t.colors.light[0],n.fillStyle=t.colors.light[0]),s?(n.beginPath(),n.moveTo((h+.7)*r,a*r),n.lineTo((h+.5)*r,(a+.2)*r),n.lineTo((h+.5)*r,(a+.5)*r),n.lineTo((h+.2)*r,(a+.5)*r),n.lineTo(h*r,(a+.7)*r),n.lineTo((h-.2)*r,(a+.5)*r),n.lineTo((h-.5)*r,(a+.5)*r),n.lineTo((h-.5)*r,(a+.2)*r),n.lineTo((h-.7)*r,a*r),n.lineTo((h-.5)*r,(a-.2)*r),n.lineTo((h-.5)*r,(a-.5)*r),n.lineTo((h-.2)*r,(a-.5)*r),n.lineTo(h*r,(a-.7)*r),n.lineTo((h+.2)*r,(a-.5)*r),n.lineTo((h+.5)*r,(a-.5)*r),n.lineTo((h+.5)*r,(a-.2)*r),n.closePath(),n.stroke()):(n.beginPath(),n.arc(h*r,a*r,r/3,0,2*Math.PI,!1),n.stroke(),e&&n.fill(),o&&(n.beginPath(),n.arc(h*r,a*r,r/2,0,2*Math.PI,!1),n.stroke()))}},{key:"drawProbe",value:function(){this.drawElement(this.mission.probe.position,!0,!1,!1)}},{key:"drawTargets",value:function(){var t=this;this.mission.targets.positions.forEach(function(i,s){t.drawElement(i,!1,s===t.selected,t.mission.targets.checked[s])})}},{key:"draw",value:function(){this.computeDimensions(),this.drawFullGrids(),this.drawProbe(),this.drawTargets()}},{key:"select",value:function(t){this.selected=t,this.draw()}}]),s}();exports.default=a;
},{"./consts.js":"E8WP"}],"xNvZ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t=require("./consts.js"),e=require("./display.js"),i=s(require("./vector.js"));function s(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}function r(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t}var l=function(){function s(t,n,r){o(this,s),this.parent=t,this.root=this.parent.root,this.pos=n,this.size=new i.default(40,7),this.callback=r||function(){},this.text="",this.menuItem=new e.P83MenuItem(this,i.default.add(this.pos,new i.default(2,4)),"OK",this.draw.bind(this),this.quit.bind(this))}return r(s,[{key:"show",value:function(t){this.text=t.toUpperCase(),this.parent.draw(),this.draw()}},{key:"draw",value:function(){var e=this.root.ctx,i=this.root.unit;e.fillStyle="#000000",e.strokeStyle=t.colors.light[0],e.shadowBlur=i,e.fillRect(this.pos.x*i,this.pos.y*i,this.size.x*i,this.size.y*i),e.strokeRect(this.pos.x*i,this.pos.y*i,this.size.x*i,this.size.y*i),e.shadowBlur=0,e.fillStyle=t.colors.light[0],e.textAlign="left",e.font=Math.floor(.8*i)+"px Liberation",e.textBaseline="middle",e.fillText(this.text,(this.pos.x+2)*i,(this.pos.y+2.5)*i),this.menuItem.draw()}},{key:"onClick",value:function(t){this.menuItem.onClick(t)}},{key:"quit",value:function(){this.menuItem.button.lit=!1,this.callback()}}]),s}();exports.default=l;
},{"./consts.js":"E8WP","./display.js":"Dcy0","./vector.js":"ji7c"}],"niua":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=require("./consts.js"),t=h(require("./mission.js")),i=l(require("./panels.js")),s=h(require("./scope.js")),n=h(require("./splash.js")),o=require("./targets.js"),r=h(require("./vector.js"));function a(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return a=function(){return e},e}function l(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=a();if(t&&t.has(e))return t.get(e);var i={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var o=s?Object.getOwnPropertyDescriptor(e,n):null;o&&(o.get||o.set)?Object.defineProperty(i,n,o):i[n]=e[n]}return i.default=e,t&&t.set(e,i),i}function h(e){return e&&e.__esModule?e:{default:e}}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}function d(e,t,i){return t&&c(e.prototype,t),i&&c(e,i),e}var f=function(){function a(e,n,l){u(this,a),this.parent=e,this.root=this.parent.root,this.mission=new t.default(n.name,n.code,n.positions,n.diagonalAllowed,n.trackingAllowed,n.oxygen),this.quitCallback=l,this.thrustPanel=new i.P83ThrustPanel(this,r.default.zero,this.mission,this.move.bind(this)),this.speedPanel=new i.P83XYPanel(this,new r.default(0,14),"SPEED",this.mission.probe.speed),this.positionPanel=new i.P83XYPanel(this,new r.default(0,21),"POSITION",this.mission.probe.position),this.scope=new s.default(this,new r.default(14,0),new r.default(28,28),this.mission),this.statusPanel=new i.default(this,new r.default(42,0),this.mission),this.targetSelector=new o.P83TargetSelector(this,new r.default(42,7),this.mission,this.scope.select.bind(this)),this.sequencePanel=new i.P83SequencePanel(this,new r.default(0,28),this.mission,this.move.bind(this)),this.missionPanel=new i.P83MissionPanel(this,new r.default(42,28),this.mission,this.quit.bind(this)),this.children=[this.thrustPanel,this.speedPanel,this.positionPanel,this.scope,this.statusPanel,this.targetSelector,this.sequencePanel,this.missionPanel]}return d(a,[{key:"draw",value:function(){var e=!0,t=!1,i=void 0;try{for(var s,n=this.children[Symbol.iterator]();!(e=(s=n.next()).done);e=!0){s.value.draw()}}catch(o){t=!0,i=o}finally{try{e||null==n.return||n.return()}finally{if(t)throw i}}}},{key:"move",value:function(t){return 0!==this.mission.oxygenLevel&&(this.mission.move(t),this.mission.isSpeedOk?(this.statusPanel.trackingLED.blink(0),this.speedPanel.led.colors=e.colors.green):(this.statusPanel.trackingLED.blink(1),this.speedPanel.led.colors=e.colors.red,this.speedPanel.led.blink(1)),this.mission.oxygenLevel<=0&&this.statusPanel.oxygenLED.blink(1),this.root.draw(),this.mission.isAchieved?this.quit():this.mission.oxygenLevel<=0&&(this.splash=(0,n.default)(this,new r.default(8,16),this.quit.bind(this)),this.splash.show("You ran out of oxygen before achieving mission ".concat(this.mission.name,"!"))),!0)}},{key:"quit",value:function(){this.statusPanel.oxygenLED.blink(0),this.statusPanel.trackingLED.blink(0),this.speedPanel.led.blink(0),this.sequencePanel.sequenceInput.show(!1),this.quitCallback(this.mission.isAchieved)}},{key:"onClick",value:function(e){this.splash?this.splash.onClick(e):(this.thrustPanel.onClick(e),this.targetSelector.onClick(e),this.missionPanel.onClick(e))}}]),a}();exports.default=f;
},{"./consts.js":"E8WP","./mission.js":"UGYH","./panels.js":"eVqE","./scope.js":"oeM6","./splash.js":"xNvZ","./targets.js":"aUdC","./vector.js":"ji7c"}],"QcRT":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=i(require("./controller.js")),t=i(require("./splash.js")),n=i(require("./vector.js"));function i(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function o(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}var r=function(){function i(a,o){var r=this;s(this,i);var l=JSON.parse(document.getElementById(o).innerText);console.log({data:l}),this.root=this,this.canvas=document.getElementById(a),this.ctx=this.canvas.getContext("2d"),this.state=i.GAME_STATE_MISSION,this.splash=null,this.controller=new e.default(this,l,function(e){e||(window.location.pathname="/");var i=new Headers;i.append("Content-Type","application/json"),fetch(window.location.pathname,{method:"POST",body:JSON.stringify({sequence:r.controller.mission.sequence,user:l.user,level:l.level}),headers:i}).then(function(e){r.splash=new t.default(r,new n.default(8,16),function(){200===e.status?window.location.pathname="/":window.location.reload()}),200===e.status?r.splash.show("Mission accomplished!"):r.splash.show("Sequence has not been verified!")}).catch(function(e){r.splash=new t.default(r,new n.default(8,16),function(){window.location.reload()}),r.splash.show("Error: ".concat(e))})}),this.resize(),window.addEventListener("resize",this.resize.bind(this)),this.canvas.addEventListener("click",function(e){var t=e.pageX-r.canvas.offsetLeft,i=e.pageY-r.canvas.offsetTop,s=new n.default(t,i);r.splash?r.splash.onClick(s):r.controller.onClick(s)})}return o(i,[{key:"draw",value:function(){this.ctx.fillStyle="#000",this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height),this.controller.draw()}},{key:"resize",value:function(){this.unit=Math.floor(Math.min(window.innerWidth/56,window.innerHeight/35)),this.canvas.width=56*this.unit,this.canvas.height=35*this.unit,this.draw()}}]),i}();exports.default=r,r.GAME_STATE_MAP=Symbol(),r.GAME_STATE_MISSION=Symbol();
},{"./controller.js":"niua","./splash.js":"xNvZ","./vector.js":"ji7c"}],"A2T1":[function(require,module,exports) {
"use strict";var e=t(require("./game.js"));function t(e){return e&&e.__esModule?e:{default:e}}var a=document.getElementById("music");a&&(a.volume=.01,a.play()),document.addEventListener("load",function(){}),new e.default("canvas","data");
},{"./game.js":"QcRT"}]},{},["A2T1"], null)
//# sourceMappingURL=/app.js.map